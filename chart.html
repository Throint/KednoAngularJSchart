<!DOCTYPE html>
<html ng-app="MyApp">
<head>
    
    <base href="https://demos.telerik.com/kendo-ui/line-charts/index">
    <style>html { font-size: 14px; font-family: Arial, Helvetica, sans-serif; }</style>
    <title></title>
    
    
    

</head>
<body>
    <div ng-controller="divController">
        <select ng-init="List = data[0]" ng-model="List" ng-options="user as user.Surname for user in data"ng-change="change(List)" >
        
        </select>
    <div id="example">
    <div class="demo-section k-content wide">
        <div id="chart" style="background: center no-repeat url('../content/shared/styles/world-map.png');"></div>
   
   
       
    
   
   <button id="ShowChart">Chart</button>
   
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
  
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2021.2.616/styles/kendo.default-v2.min.css" />
     <script src="https://kendo.cdn.telerik.com/2021.2.616/js/jquery.min.js"></script>       
    <script src="https://kendo.cdn.telerik.com/2021.2.616/js/kendo.all.min.js"></script>
    <script>
         var myApp=angular.module('MyApp', []);
    angular.module("MyApp", []).controller("divController", function ($scope) {
        $scope.data=[];
        $scope.List={};
        $scope.data=RandomGenerator();

 $scope.change=function(s)
{
 
  if(s!=null)
  {
       $scope.data=[];
  $scope.data.push(s.Salary);
  

  $scope.series=[];
  $scope.series.push(s.Surname);

  $scope.data.push(s.Average);
  $scope.series.push("Average value");

//   $scope.data.push(s.Approx);
//   $scope.series.push("Approximated");

 
  var curUserIndex= 0;
  for(var iter=0; iter<$scope.data.length;iter++)
  {
    if(($scope.data[iter].Name==s.Name ) &&($scope.data[iter].Surname==s.Surname))
    {
      curUserIndex=iter;
      break;
    }
  }
  $scope.max= getMax($scope.data[curUserIndex]);
  $scope.min=getMin($scope.data[curUserIndex]);
}
  $scope.currUser=curUserIndex;
  
  
}

    //    $(document).ready(createChart($scope.data.Name, $scope.data.Salary));
    $("#ShowChart").click(function(){



        createChart($scope.data[0].Name, $scope.data[0].Salary);
    });
        $(document).bind("kendo:skinChange", createChart);
    });
    function createChart(x, y) {
            $("#chart").kendoChart({
                title: {
                    text: ""
                },
                legend: {
                    position: "bottom"
                },
                chartArea: {
                    background: ""
                },
                seriesDefaults: {
                    type: "line",
                    style: "smooth"
                },
                series: [{
                    name: x,
                    data: y
                },
               
            ],
                valueAxis: {
                    labels: {
                        format: "{0}"
                    },
                    line: {
                        visible: false
                    },
                    axisCrossingValue: -10
                },
                categoryAxis: {
                    categories: ["Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sep", "Oct", "Nov", "Dec"],
                    majorGridLines: {
                        visible: false
                    },
                    labels: {
                        rotation: "auto"
                    }
                },
                tooltip: {
                    visible: true,
                    format: "{0}",
                    template: "#= series.name #: #= value #"
                }
            });
        }
       
        
function getMax(arr)
{
  var max=0;
 var tmp=[];
 for(var i=0;i<arr.length;i++)
 {
   tmp.push(arr[i]);
 }
  tmp.sort(function(a, b) {
  return a - b;
});
 var max=tmp[tmp.length-1];
 var index=arr.indexOf(max);
  return ((index+1)>9)? `${max} at 01/${index+1}`:`${max} at 01/0${index+1}`;
}

function getMin(arr)
{
  var tempArr=[];
  for(var i=0;i<arr.length;i++)
  {
    tempArr.push(arr[i]);
  }
  tempArr.sort(function(a, b) {
  return a - b;
});
var min =tempArr[0];
var index= arr.indexOf(min);
return ((index+1)>9)? `${min} at 01/${index+1}`:`${min} at 01/0${index+1}`;
 
}
function RandomGenerator(){
    var obj=[];
    for(var i=0;i<10;i++)
    {
        var salariesPerYear=[];
        for(var j=0;j<12;j++)
        {
        var salary= Math.random()*1500+i+j;
        salariesPerYear.push(salary);
        }
       // var approx=getApprox(salariesPerYear);
        var avrSalary=0;
        for(var z=0;z<12;z++)
        {
          avrSalary+=salariesPerYear[z];
        }
        avrSalary/=12;
        var avrArr=[];
        for(var avrI=0;avrI<12;avrI++)
        {
          avrArr.push(avrSalary);
        }
            var tmp={
                Name:`Test0${i}`,
                Surname: `User0${i}`,
                Salary:salariesPerYear,
                Average:avrArr,
              //  Approx:approx
            }
    
            obj.push(tmp);
    }
   
    return obj;
}
        function RandomGenerator(){
    var obj=[];
    for(var i=0;i<10;i++)
    {
        var salariesPerYear=[];
        for(var j=0;j<12;j++)
        {
        var salary= Math.random()*1500+i+j;
        salariesPerYear.push(salary);
        }
      //  var approx=getApprox(salariesPerYear);
        var avrSalary=0;
        for(var z=0;z<12;z++)
        {
          avrSalary+=salariesPerYear[z];
        }
        avrSalary/=12;
        var avrArr=[];
        for(var avrI=0;avrI<12;avrI++)
        {
          avrArr.push(avrSalary);
        }
            var tmp={
                Name:`Test0${i}`,
                Surname: `User0${i}`,
                Salary:salariesPerYear,
                Average:avrArr
               // Approx:approx
            }
    
            obj.push(tmp);
    }
   
    return obj;
}
    </script>
    </div>
    </div>


    

</body>
</html>
